{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-function.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// create gallery elements\nconst renderFunc = dataArray => {\n  const itemsArr = dataArray\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <li class= \"list-item\">\n    <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" class=\"list-img\"></a>\n <ul class = \"content-list\">\n <li class=\"content-list-item\">\n <p class=\"content-list-title\">Likes</p>\n <p class=\"content-list-value\">${likes}</p>\n </li>\n <li class=\"content-list-item\">\n <p class=\"content-list-title\">Views</p>\n <p class=\"content-list-value\">${views}</p>\n </li>\n <li class=\"content-list-item\">\n <p class=\"content-list-title\">Comments</p>\n <p class=\"content-list-value\">${comments}</p>\n </li>\n <li class=\"content-list-item\">\n <p class=\"content-list-title\">Downloads</p>\n <p class=\"content-list-value\">${downloads}</p>\n </li>\n </ul>\n    </li>\n    `\n    )\n    .join(' ');\n\n  return itemsArr;\n};\n\nclass itemService {\n  constructor(itemToService, hiddenClass) {\n    this.itemToService = itemToService;\n    this.hiddenClass = hiddenClass;\n  }\n\n  hide() {\n    this.itemToService.classList.add(this.hiddenClass);\n  }\n\n  show() {\n    this.itemToService.classList.remove(this.hiddenClass);\n  }\n\n  disable() {\n    this.itemToService.disabled = true;\n  }\n\n  enable() {\n    this.itemToService.disabled = false;\n  }\n}\n\n// lightbox initialization\nvar lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport { renderFunc, itemService, lightbox };\n","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst API_KEY = '45132355-1a938d4dc3b6908ed12965e8f';\n\nconst receiveDataFromServer = async ({ page, perPage, q }) => {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: perPage,\n  });\n\n  const response = await axios.get(`?${searchParams}`);\n\n  return response.data;\n};\n\nexport default receiveDataFromServer;\n","import { renderFunc, itemService, lightbox } from './js/render-function';\nimport receiveDataFromServer from './js/pixabay-api';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst loader = document.querySelector('.loader');\nconst loadMoreLoader = document.querySelector('.load-more');\nconst loadMoreButton = document.querySelector('.position');\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\n\nlet params = {\n  page: 1,\n  perPage: 15,\n  maxPages: 0,\n  q: '',\n  heightOfCard: 0,\n};\n\nconst loaderHide = new itemService(loader, 'visually-hidden');\nconst loaderMoreHide = new itemService(loadMoreLoader, 'visually-hidden');\nconst buttonMoreHide = new itemService(loadMoreButton, 'visually-hidden');\n\nasync function searchFunc(event) {\n  event.preventDefault();\n\n  loaderHide.show();\n\n  params.page = 1;\n  params.q = event.currentTarget.elements.information.value.trim();\n\n  try {\n    const data = await receiveDataFromServer(params);\n\n    if (data.totalHits === 0) {\n      loaderHide.hide();\n      gallery.innerHTML = '';\n      buttonMoreHide.hide();\n\n      return iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n\n    const itemsToDrawArr = renderFunc(data.hits);\n    loaderHide.hide();\n\n    gallery.innerHTML = '';\n    gallery.insertAdjacentHTML('afterbegin', itemsToDrawArr);\n\n    params.heightOfCard =\n      gallery.firstElementChild.getBoundingClientRect().height;\n\n    params.maxPages = Math.ceil(data.totalHits / params.perPage);\n\n    lightbox.refresh();\n\n    if (params.page !== params.maxPages) {\n      buttonMoreHide.show();\n      loadMoreButton.addEventListener('click', loadMore);\n    } else {\n      buttonMoreHide.hide();\n      loadMoreButton.removeEventListener('click', loadMore);\n    }\n  } catch (error) {\n    loaderHide.hide();\n    gallery.innerHTML = '';\n\n    return iziToast.warning({\n      title: 'Error : ',\n      message: error,\n      position: 'topRight',\n    });\n  } finally {\n    form.reset();\n  }\n}\n\nasync function loadMore() {\n  buttonMoreHide.disable();\n  loaderMoreHide.show();\n  params.page += 1;\n\n  try {\n    const data = await receiveDataFromServer(params);\n\n    const itemsToDrawArr = renderFunc(data.hits);\n\n    loaderMoreHide.hide();\n\n    gallery.insertAdjacentHTML('beforeend', itemsToDrawArr);\n\n    console.log(gallery.childElementCount);\n\n    lightbox.refresh();\n\n    window.scrollBy(0, 2 * params.heightOfCard);\n\n    if (params.maxPages === params.page) {\n      buttonMoreHide.hide();\n      loadMoreButton.removeEventListener('click', loadMore);\n      return iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results\",\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    loaderHide.hide();\n    buttonMoreHide.hide();\n    gallery.innerHTML = '';\n    loadMoreButton.removeEventListener('click', loadMore);\n    return iziToast.warning({\n      title: 'Error : ',\n      message: error,\n      position: 'topRight',\n    });\n  } finally {\n    buttonMoreHide.enable();\n  }\n}\n\nform.addEventListener('submit', searchFunc);\n"],"names":["renderFunc","dataArray","webformatURL","largeImageURL","tags","likes","views","comments","downloads","itemService","itemToService","hiddenClass","lightbox","SimpleLightbox","axios","API_KEY","receiveDataFromServer","page","perPage","q","searchParams","loader","loadMoreLoader","loadMoreButton","form","gallery","params","loaderHide","loaderMoreHide","buttonMoreHide","searchFunc","event","data","iziToast","itemsToDrawArr","loadMore","error"],"mappings":"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"}